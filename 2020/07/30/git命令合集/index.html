<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="git," />





  <link rel="alternate" href="/atom.xml" title="DaliBlogs" type="application/atom+xml" />






<meta name="description" content="git命令git中https和SSH的clone方式区别  在git中clone项目有两种方式：HTTPS和SSH，它们的区别如下： HTTPS：不管是谁，拿到url随便clone，但是在push的时候需要验证用户名和密码； SSH：clone的项目你必须是拥有者或者管理员，而且需要在clone前添加SSH Key。SSH 在push的时候，是不需要输入用户名的，如果配置SSH key的时候设置了">
<meta property="og:type" content="article">
<meta property="og:title" content="git命令合集">
<meta property="og:url" content="http://yoursite.com/2020/07/30/git%E5%91%BD%E4%BB%A4%E5%90%88%E9%9B%86/index.html">
<meta property="og:site_name" content="DaliBlogs">
<meta property="og:description" content="git命令git中https和SSH的clone方式区别  在git中clone项目有两种方式：HTTPS和SSH，它们的区别如下： HTTPS：不管是谁，拿到url随便clone，但是在push的时候需要验证用户名和密码； SSH：clone的项目你必须是拥有者或者管理员，而且需要在clone前添加SSH Key。SSH 在push的时候，是不需要输入用户名的，如果配置SSH key的时候设置了">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9XmZUicqmfmQQXfknLKRNWh9vPibmsyvot1l9lwJpicib8zAQjAmD7Mv9Cg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9H1qJcFZE6mtIxEQKmzsht2LQz74e0zEnMwaXricZ0msrFZY1Nb4JUIw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9g4rDlrqSsbI00RJDC1sbpdshFjyeDwbVfHYZwlEn6JSXfO5JWydDYg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9nxScpZUUdzmTWO3zMLKEibibVS3r5dKibjCdB5M2ibIjkfmWhBUicb0ukfg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9yHhiaNkyGJshQDVfLxgERUkXQEV8Uib67dOIqf1bG2ZpjhdbvrYpuFQw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9g1SCYDEib7Fo4sK4Frfr6jPibbaS9P3ARvRDnqibuickjXWQ1EwnBlV4hQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9oicUzRnDBLbTxL0yH5U6X9NETY6WTV7IeJEHH3aOZnZ4iaDXysyYPjmQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9m9icO51OGWfBz3B6KYY7QA94JdBF7RjWOaJ8b1XtDVg9jp9Ga3EroWw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9XXtzQlDdITL8CcPWvJY0iaHS6XWOFnW9LEoricldTnw8ozEicv95kkvEg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9ojyJ617kWBtRDB0mYMjTxLTS0QbLTqqqns3ULaWzwLnElJNrhZJbWA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9iawwujQXpjWWrf9HicXpKZXQSjwq7dk5MJ7y7z4hVO3QPWlr3QNREP0w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9bPYKvhdQa4xmPfT0BuePD1XT9JoPfbvygbX7eQ2vkNcTtucwBuHlsw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb99nf6xw3UVlcFvlMdF2e1VZrxFOiciawG9WR6oua3BviaMZkOBvVevr0qA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb94I6Ao3GiaQqdpoGdjPSrra6CopjZ6kfCiap0X4olUMlgSQ8tp7GQlXicQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9W190VJCiapx51Yqo5r55PzgPhBwX8n88zUp19e70pW3Rpia7fkEp1lPQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb91cQuaeDQ2DS2Xdvu3TeHvHl1BWlvm46icOF6gPXSe2icm0rzEqXdJkNA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9iawwujQXpjWWrf9HicXpKZXQSjwq7dk5MJ7y7z4hVO3QPWlr3QNREP0w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1b2c9f2b1ea1447b8daed1c7568b1bfe~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/349e2b8829454c07a916bf8c060ca8db~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image">
<meta property="article:published_time" content="2020-07-30T00:20:26.000Z">
<meta property="article:modified_time" content="2023-01-04T05:35:52.310Z">
<meta property="article:author" content="Dali">
<meta property="article:tag" content="git">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9XmZUicqmfmQQXfknLKRNWh9vPibmsyvot1l9lwJpicib8zAQjAmD7Mv9Cg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/07/30/git命令合集/"/>





  <title>git命令合集 | DaliBlogs</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">DaliBlogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/30/git%E5%91%BD%E4%BB%A4%E5%90%88%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dali">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/header.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DaliBlogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">git命令合集</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-07-30T08:20:26+08:00">
                2020-07-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/git/" itemprop="url" rel="index">
                    <span itemprop="name">git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="git命令"><a href="#git命令" class="headerlink" title="git命令"></a>git命令</h1><p>git中https和SSH的clone方式区别</p>
<ul>
<li>在git中clone项目有两种方式：HTTPS和SSH，它们的区别如下：</li>
<li>HTTPS：不管是谁，拿到url随便clone，但是在push的时候需要验证用户名和密码；</li>
<li>SSH：clone的项目你必须是拥有者或者管理员，而且需要在clone前添加SSH Key。SSH 在push的时候，是不需要输入用户名的，如果配置SSH key的时候设置了密码，则需要输入密码的，否则直接是不需要输入密码的。</li>
<li>在git中使用SSH Key的步骤：</li>
<li>检查电脑是否存在SSH Key：$ cd ~/.ssh$ ls</li>
<li>如果存在id_rsa.pub 或 id_dsa.pub 文件，说明文件以及存在，跳过创建SSH Key步骤。</li>
<li>创建SSH Key</li>
<li>将公共的SSH 放到远程仓库上</li>
</ul>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">:wq 保存提交信息</span><br><span class="line">q 退出</span><br><span class="line"></span><br><span class="line">git branch dali 创建分支</span><br><span class="line">git branch 或者git branch --list查看分支</span><br><span class="line">git branch -a 查看当前所在分支 </span><br><span class="line">git branch -r 查看远程分支</span><br><span class="line">git branch -m dali dali01 重命名成dali01</span><br><span class="line">git branch -d dali01 删除分支dali01</span><br><span class="line">git checkout dali 切换分支</span><br><span class="line"></span><br><span class="line">git push -u origin master 将本地推送到远程</span><br><span class="line">git clone https:&#x2F;&#x2F;git 新名字</span><br><span class="line">git fetch 提取远程代码</span><br><span class="line"></span><br><span class="line">git merge dali 将dali分支合到本地分支 </span><br><span class="line">git fast-forward 出现代表快速合并，本地没有任何提交，会直接合并</span><br><span class="line">git remote add origin https:&#x2F;&#x2F;git 添加远程库</span><br><span class="line">git remote 查看远程库</span><br><span class="line">git remote -v更详细的远程库</span><br><span class="line"></span><br><span class="line">git 或者 git help --查看帮助</span><br><span class="line">git help -a --查看所有命令</span><br><span class="line">git help -g --查看所有手册</span><br><span class="line">git help add --加上命令或名称，查看详细内容 （F键向下，B键向上翻页，Q键退出）</span><br><span class="line"></span><br><span class="line">git config --global user.name &#39;dali&#39; 设置用户名</span><br><span class="line">git config --global user.email &#39;dali.com&#39;设置邮箱</span><br><span class="line">git config --List 查看用户信息</span><br><span class="line">git config --unset --global user.name 清空用户名</span><br><span class="line">git config color.ui true 设置颜色</span><br><span class="line">git config --global alias.co checkout 给checkout起一个co的别名</span><br><span class="line">cat &#96;&#x2F;.gitconfig 查看当前用户的配置</span><br><span class="line"></span><br><span class="line">git init 初始化git</span><br><span class="line">git status 查看分支什么的</span><br><span class="line"></span><br><span class="line">git add . 添加所有文件到暂存区</span><br><span class="line">git add &#39;index.html&#39; 添加具体文件到暂存区</span><br><span class="line">git commit -m &#39;新建index.html文件&#39;</span><br><span class="line">git commit -am &#39;省略add，直接commit&#39;</span><br><span class="line"></span><br><span class="line">git diff 查看前后对比</span><br><span class="line">git diff --staged 查看暂存区和git上的区别</span><br><span class="line"></span><br><span class="line">git mv style.css  theme.css   将style重命名成theme</span><br><span class="line">git mv theme.css css&#x2F;    将theme.css移动到css文件夹下</span><br><span class="line">git mv css asset&#x2F;    将css移动到asset文件夹下</span><br><span class="line"></span><br><span class="line">git rm theme.css 删除theme.css文件</span><br><span class="line">git rm theme.css style.css文件（多个文件以空格分离）</span><br><span class="line">git rm -r 我的文件夹&#x2F; （删除目录以及所有内容 加上 -r  和目录的名称 表示递归）</span><br><span class="line"></span><br><span class="line">git checkout HEAD  -- index.html 恢复上一次修改</span><br><span class="line">git checkout HEAD^  -- index.html 恢复上一次提交</span><br><span class="line">git revert (提交id) --撤销某一次提交</span><br><span class="line"></span><br><span class="line">其中HEAD代表版本库，index代表暂存区，另外还有一个我们增删改代码的工作区。</span><br><span class="line">--hard : 回退版本库，暂存区，工作区。（因此我们修改过的代码就没了，需要谨慎使用）</span><br><span class="line">--mixed: 回退版本库，暂存区。(--mixed为git reset的默认参数，即当任何参数都不加的时候的参数)</span><br><span class="line">--soft: 回退版本库。</span><br><span class="line">只commit 没有push</span><br><span class="line">git reset --soft （提交id）--撤销commit，工作区代码本地更改留存</span><br><span class="line">git reset --hard（提交id）--慎用 撤销commit，工作区代码本地更改不留存</span><br><span class="line">git reset --mixed（提交id）--版本库和暂存区都将进行了代码回退，工作区代码没动</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">git diff master..dali 查看两个分支的不同</span><br><span class="line">git diff master..dali index.html 具体文件的不同</span><br><span class="line"></span><br><span class="line">abort 放弃合并</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;&lt; HEAD和&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;之间是本地的代码</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 和&gt;&gt;&gt;&gt;&gt;之间是远程的代码</span><br><span class="line"></span><br><span class="line">git log --oneline --decorate --all -10 --graph --atuhor&#x3D;&#39;dali&#39;  --grep&#x3D;&#39;index.html&#39; --before&#x3D;’2020-20-02‘ </span><br><span class="line">--before&#x3D;&#39;1 week&#39; --before&#x3D;&#39;3 days&#39; 提交日志</span><br><span class="line"> --oneline一行显示</span><br><span class="line"> decorate 查看具体分支</span><br><span class="line"> --all -10前十条</span><br><span class="line"> --graph 图形化</span><br><span class="line"> --atuhor作者</span><br><span class="line"> --grep包含 </span><br><span class="line">--before某个日期之前的，一周内，三天内的提交 </span><br><span class="line"></span><br><span class="line">stash 保存修改&#x2F;工作进度</span><br><span class="line">git stash save &#39;增加一条工作进度&#39;</span><br><span class="line">git stash list 保存工作进度的列表</span><br><span class="line">git stash apply stash@&#123;0&#125;恢复工作进度</span><br><span class="line">git stash drop stash@&#123;0&#125;删除工作进度</span><br><span class="line">git stash show -p stash@&#123;0&#125;显示区别（-p是指 以patch form的的方式展示diff）</span><br></pre></td></tr></table></figure>

<p>补充链接 <a href="https://mp.weixin.qq.com/s/-DjGBDi7HQfVpGNY8sOCmw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/-DjGBDi7HQfVpGNY8sOCmw</a></p>
<p>​                <a href="https://mp.weixin.qq.com/s/4vfifX-UkhrfpZjHycthOA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/4vfifX-UkhrfpZjHycthOA</a></p>
<h1 id="简述git原理"><a href="#简述git原理" class="headerlink" title="简述git原理"></a>简述git原理</h1><p><a href="https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&amp;mid=2247495243&amp;idx=1&amp;sn=1c94ff327ce87ade9c03fa655af7f0df&amp;chksm=e92ad344de5d5a52ff3df8ede8b012185690fde77fe2f95488359c98707bd7f66579815ce263&amp;scene=178&amp;cur_album_id=1419161363276169216#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&amp;mid=2247495243&amp;idx=1&amp;sn=1c94ff327ce87ade9c03fa655af7f0df&amp;chksm=e92ad344de5d5a52ff3df8ede8b012185690fde77fe2f95488359c98707bd7f66579815ce263&amp;scene=178&amp;cur_album_id=1419161363276169216#rd</a></p>
<h1 id="一文讲透-Git-底层数据结构和原理"><a href="#一文讲透-Git-底层数据结构和原理" class="headerlink" title="一文讲透 Git 底层数据结构和原理"></a>一文讲透 Git 底层数据结构和原理</h1><p><a href="https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&amp;mid=2247496082&amp;idx=1&amp;sn=4995262c811e73119189174969e53ff2&amp;chksm=e92acc9dde5d458b2ab75321a684a5a6229c6d323fc332a75a2d2b0136e9f28a2a60f6d8f657&amp;scene=178&amp;cur_album_id=1419161363276169216#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&amp;mid=2247496082&amp;idx=1&amp;sn=4995262c811e73119189174969e53ff2&amp;chksm=e92acc9dde5d458b2ab75321a684a5a6229c6d323fc332a75a2d2b0136e9f28a2a60f6d8f657&amp;scene=178&amp;cur_album_id=1419161363276169216#rd</a></p>
<p><strong>状态模型</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9XmZUicqmfmQQXfknLKRNWh9vPibmsyvot1l9lwJpicib8zAQjAmD7Mv9Cg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>上图描述了 git 对象的在不同的生命周期中不同的存储位置，通过不同的 git 命令改变 git 对象的存储生命周期。</p>
<p>工作区 (workspace)</p>
<p>就是我们当前工作空间，也就是我们当前能在本地文件夹下面看到的文件结构。初始化工作空间或者工作空间 clean 的时候，文件内容和 index 暂存区是一致的，随着修改，工作区文件在没有 add 到暂存区时候，工作区将和暂存区是不一致的。</p>
<p>暂存区 (index)</p>
<p>老版本概念也叫 Cache 区，就是文件暂时存放的地方，所有暂时存放在暂存区中的文件将随着一个 commit 一起提交到 local repository 此时 local repository 里面文件将完全被暂存区所取代。暂存区是 git 架构设计中非常重要和难理解的一部分。</p>
<p>本地仓库 (local repository)</p>
<p>git 是分布式版本控制系统，和其他版本控制系统不同的是他可以完全去中心化工作，你可以不用和中央服务器 (remote server) 进行通信，在本地即可进行全部离线操作，包括 log，history，commit，diff 等等。完成离线操作最核心是因为 git 有一个几乎和远程一样的本地仓库，所有本地离线操作都可以在本地完成，等需要的时候再和远程服务进行交互。</p>
<p>远程仓库 (remote repository)</p>
<p>中心化仓库，所有人共享，本地仓库会需要和远程仓库进行交互，也就能将其他所有人内容更新到本地仓库把自己内容上传分享给其他人。结构大体和本地仓库一样。</p>
<p>文件在不同的操作下可能处于不同的 git 生命周期，下面看看一个文件变化的例子。</p>
<p>文件变化</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9H1qJcFZE6mtIxEQKmzsht2LQz74e0zEnMwaXricZ0msrFZY1Nb4JUIw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><strong>对象模型</strong></p>
<p>仓库结构</p>
<p>git 分布式的一个重要体现是 git 在本地是有一个完整的 git 仓库也就是 .git 文件目录，通过这个仓库，git 就可以完全离线化操作。在这个本地化的仓库中存储了 git 所有的模型对象。下面是 git 仓库的 tree 和相关说明：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9g4rDlrqSsbI00RJDC1sbpdshFjyeDwbVfHYZwlEn6JSXfO5JWydDYg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>git 主要有四个对象，分别是 Blob，Tree， Commit， Tag 他们都用 SHA-1 进行命名。</p>
<p>你可以用 git cat-file -t 查看每个 SHA-1 的类型，用 git cat-file -p 查看每个对象的内容和简单的数据结构。git cat-file 是 git 的瑞士军刀，是底层核心命令。</p>
<p>Blob 对象</p>
<p>只用于存储单个文件内容，一般都是二进制的数据文件，不包含任何其他文件信息，比如不包含文件名和其他元数据。</p>
<p>Tree 对象</p>
<p>对应文件系统的目录结构，里面主要有：子目录 (tree)，文件列表 (blob)，文件类型以及一些数据文件权限模型等。</p>
<p>如下图输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">→ git cat-file -t ed807a4d010a06ca83d448bc74c6cc79121c07c3tree→ git cat-file -p ed807a4d010a06ca83d448bc74c6cc79121c07c3100644 blob 36a982c504eb92330573aa901c7482f7e7c9d2e6    .cise.yml100644 blob c439a8da9e9cca4e7b29ee260aea008964a00e9a    .eslintignore100644 blob 245b35b9162bec4ef798eb05b533e6c98633af5c    .eslintrc100644 blob 10123778ec5206edcd6e8500cc78b77e79285f6d    .gitignore100644 blob 1a48aa945106d7591b6342585b1c29998e486bf6    README.md100644 blob 514f7cb2645f44dd9b66a87f869d42902174fe40    abc.json040000 tree 8955f46834e3e35d74766639d740af922dcaccd3    cli_list100644 blob f7758d0600f6b9951cf67f75cf0e2fabcea55771    dep.json040000 tree e2b3ee59f6b030a45c0bf2770e6b0c1fa5f1d8c7    doc100644 blob e3c712d7073957c3376d182aeff5b96f28a37098    index.js040000 tree b4aadab8fc0228a14060321e3f89af50ba5817ca    lib040000 tree 249eafef27d9d8ebe966e35f96b3092d77485a79    mock100644 blob 95913ff73be1cc7dec869485e80072b6abdd7be4    package.json040000 tree e21682d1ebd4fdd21663ba062c5bfae0308acb64    src040000 tree 91612a9fa0cea4680228bfb582ed02591ce03ef2    static040000 tree d0265f130d2c5cb023fe16c990ecd56d1a07b78c    task100644 blob ab04ef3bda0e311fc33c0cbc8977dcff898f4594    webpack.config.js100644 blob fb8e6d3a39baf6e339e235de1a9ed7c3f1521d55    webpack.dll.config.js040000 tree 5dd44553be0d7e528b8667ac3c027ddc0909ef36    webpack</span><br></pre></td></tr></table></figure>



<p>详细解释如下：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9nxScpZUUdzmTWO3zMLKEibibVS3r5dKibjCdB5M2ibIjkfmWhBUicb0ukfg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>Commit 对象</p>
<p>是一次修改的集合，当前所有修改的文件的一个集合，可以类比一批操作的“事务”。是修改过的文件集的一个快照，随着一次 commit 操作，修改过的文件将会被提交到 local repository 中。通过 commit 对象，在版本化中可以检索出每次修改内容，是版本化的基石。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">→ git cat-file -t fbf9e415f77008b780b40805a9bb996b37a6ad2ccommit→ git cat-file -p fbf9e415f77008b780b40805a9bb996b37a6ad2ctree bd31831c26409eac7a79609592919e9dcd1a76f2parent d62cf8ef977082319d8d8a0cf5150dfa1573c2b7author xxx  1502331401 +0800committer xxx  1502331401 +0800修复增量bug</span><br></pre></td></tr></table></figure>







<p>详细解释如下：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9yHhiaNkyGJshQDVfLxgERUkXQEV8Uib67dOIqf1bG2ZpjhdbvrYpuFQw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>Tag 对象</p>
<p>tag 是一个”固化的分支”，一旦打上 tag 之后，这个 tag 代表的内容将永远不可变，因为 tag 只会关联当时版本库中最后一个 commit 对象。</p>
<p>分支的话，随着不断的提交，内容会不断的改变，因为分支指向的最后一个 commit 不断改变。所以一般应用或者软件版本的发布一般用 tag。</p>
<p>git 的 Tag 类型有两种：</p>
<p><strong>1 lightweight (轻量级)</strong></p>
<p>创建方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag tagName</span><br></pre></td></tr></table></figure>



<p>这种方式创建的 Tag，git 底层不会创建一个真正意义上的 tag 对象，而是直接指向一个 commit 对象，此时如果使用 git cat-file -t tagName 会返回一个 commit。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">→ git cat-file -t v4commit→ git cat-file -p v4tree ceab4f96440655b0ff1a783316c95450fa1fb436parent 7f23c9ca70ce64fc58e8c7507c990c6c6a201d3dauthor 与水  1506224164 +0800committer 与水  1506224164 +0800</span><br><span class="line">rawtest2</span><br></pre></td></tr></table></figure>



<p><strong>2 annotated (含附注)</strong></p>
<p>创建方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag -a tagName -m&#39;&#39;</span><br></pre></td></tr></table></figure>

<p>这种方式创建的标签，git 底层会创建一个 tag 对象，tag 对象会包含相关的 commit 信息和 tagger 等额外信息，此时如果使用 git cat-file -t tagname 会返回一个 tag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">→ git cat-file -t v3tag→ git cat-file -p v3object d5d55a49c337d36e16dd4b05bfca3816d8bf6de8   &#x2F;&#x2F;commit 对象SHA-1type committag v3tagger xxx  1506230900 +0800</span><br><span class="line">与水测试标注型tag</span><br></pre></td></tr></table></figure>



<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9g1SCYDEib7Fo4sK4Frfr6jPibbaS9P3ARvRDnqibuickjXWQ1EwnBlV4hQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>总结：所有对象模型之间的关系大致如下：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9oicUzRnDBLbTxL0yH5U6X9NETY6WTV7IeJEHH3aOZnZ4iaDXysyYPjmQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><strong>存储模型</strong></p>
<p>概念</p>
<p>git 区别与其他 vcs 系统的一个最主要原因之一是：git 对文件版本管理和其他 vcs 系统对文件版本的实现理念完成不一样。这也就是 git 版本管理为什么如此强大的最核心的地方。</p>
<p>Svn 等其他的 VCS 对文件版本的理念是以文件为水平维度，记录每个文件在每个版本下的 delta 改变。</p>
<p>Git 对文件版本的管理理念却是以每次提交为一次快照，提交时对所有文件做一次全量快照，然后存储快照引用。</p>
<p>Git 在存储层，如果文件数据没有改变的文件，Git 只是存储指向源文件的一个引用，并不会直接多次存储文件，这一点可以在 pack 文件中看见。</p>
<p>如下图所示：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9m9icO51OGWfBz3B6KYY7QA94JdBF7RjWOaJ8b1XtDVg9jp9Ga3EroWw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>存储</p>
<p>随着需求和功能的不断复杂，git 版本的不断更新，但是主要的存储模型还是大致不变。如下图所示：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9XXtzQlDdITL8CcPWvJY0iaHS6XWOFnW9LEoricldTnw8ozEicv95kkvEg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><strong>检索模型</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">→ cd .git&#x2F;objects&#x2F;→ ls03   28   7f   ce   d0   d5   e6   f9   info pack</span><br></pre></td></tr></table></figure>



<p>git 的对象有两种：</p>
<p>一种是松散对象，就是在如上 .git/objects 的文件夹 03 28 7f ce d0 d5 e6 f9 等，这些文件夹只有 2 个字符开头，其实就是每个文件 SHA-1 值的前 2 个字母，最多有 #OXFF 256 个文件夹。</p>
<p>一种是打包压缩对象，打包压缩之后的对象主要存在的是 pack 文件中，主要用于文件在网络上传输，减少网络消耗。</p>
<p>为了节省存储空间，可以手动触发打包压缩操作 (git gc)，将松散对象打包成 pack 文件对象。也可以将 pack 文件解压缩成松散对象 (git unpack-objects)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">→ cd pack→ lspack-efbf3149604d24e6ea427b025da0c59245b2c2ea.idx  pack-efbf3149604d24e6ea427b025da0c59245b2c2ea.pack</span><br></pre></td></tr></table></figure>



<p>为了加快 pack 文件的检索效率，git 基于 pack 文件会生成相应的索引 idx 文件。</p>
<p>pack 文件</p>
<p>pack 文件设计非常精密和巧妙，本着降低文件大小，减少文件传输，降低网络开销和安全传输的原则设计的。</p>
<p>pack 文件设计的概图如下：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9ojyJ617kWBtRDB0mYMjTxLTS0QbLTqqqns3ULaWzwLnElJNrhZJbWA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>pack 文件主要有三部分组成，Header， Body， Trailer</p>
<ul>
<li>Header 部分主要 4-byte “PACK”, 4-byte “版本号”, 4-byte “Object 条目数”。</li>
</ul>
<ul>
<li>Body 部分主要是一个个 Git 对象依次存储，存储位置在 idx 索引文件中记录改对象在 pack 文件中的偏移量 offset。</li>
</ul>
<ul>
<li>Trailer 部分主要是所有 Objects 的名 (SHA-1）的校验和，为了安全可靠的文件传输。</li>
</ul>
<p>下面我们看具体的 pack 文件：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9iawwujQXpjWWrf9HicXpKZXQSjwq7dk5MJ7y7z4hVO3QPWlr3QNREP0w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>从上图可知：通过 idx 索引文件在 pack 文件中定位到对象之后，对象的结构主要 Header 和 Data 两部分。</p>
<p><strong>1 Header 部分</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9bPYKvhdQa4xmPfT0BuePD1XT9JoPfbvygbX7eQ2vkNcTtucwBuHlsw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>Header 中首 8-bits：1-bit 是 MSB，接着的 3-bits 表示的是当前对象类型，主要有 6种存储类型，接着的 4-bits 是用于表示该 Object 展开的 (length) 大小的一部分，只是一部分，完整的大小取决于MSB和接下来的多个 bits，完整算法如下：</p>
<ul>
<li>如果 8-bits 中第一位是 1，表示下一个字节还是 header 的一部分，用于表示该对象展开的大小。</li>
</ul>
<ul>
<li>如果 8-bits 中第一位是 0，表示从下一个字节开始，将是数据 Data 文件。</li>
</ul>
<ul>
<li>如果对象类型是 OBJ_OFS_DELTA 类型, 表示的是 Delta 存储，当前 git 对象只是存储了增量部分，对于基本的部分将由接下来的可变长度的字节数用于表示 base object 的距离当前对象的偏移量，接下来的可变字节也是用 1-bit MSB 表示下一个字节是否是可变长度的组成部分。对偏移量取负数，就可知 base 对象在当前对象的前面多少字节。</li>
</ul>
<ul>
<li>如果对象类型是 OBJ_REF_DELTA 类型，表示的是 Delta 存储，当前 git 对象只是存储了增量部分，对于基本的部分，用 20-bytes 存储 Base Object 的 SHA-1 。</li>
</ul>
<p><strong>2 Data 部分</strong></p>
<p>是经过 Zlib 压缩过的数据。可能是全部数据，也有可能是 Delta 数据，具体看 Header 部分的存储类型，如果是 OBJ_OFS_DELTA 或者 OBJ_REF_DELTA 此处存储的就是增量 (Delta) 数据，此时如果要取得全量数据的话，需要递归的找到最 Base Object，然后 apply delta 数据，在 base object 基础上进行 apply delta 数据也是非常精妙的，此文暂不做介绍。</p>
<p>从上面可以很清晰知道 pack 文件格式，我们再从本地仓库中一探究竟：</p>
<p>不是增量 delta 格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHA-1 type size size-in-packfile offset-in-packfile</span><br></pre></td></tr></table></figure>



<p>增量 delta 格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHA-1 type size size-in-packfile offset-in-packfile depth base-SHA-1</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">→ git verify-pack -v pack-efbf3149604d24e6ea427b025da0c59245b2c2ea.packcb5a93c4cf9c0ee5b7153a3a35a4fac7a7584804 commit 275 189 12399334856af4ca4b49c0008a25b6a9f524e40350 commit 69 81 201 1 cb5a93c4cf9c0ee5b7153a3a35a4fac7a7584804e0efbd5121c31964af1615cf24135a7c6c11cc1d commit 268 187 2827bc9a5e0199bd4a6d4d223ce7e13239631df9635 commit 29 41 469 1 e0efbd5121c31964af1615cf24135a7c6c11cc1d2e43c62f6ff99c88d20329487137f8dbabc8b3ec commit 220 157 510b6f173085f49f109a00b2a3f08a7dc499cc47f1f commit 220 157 6670466b3f1aadde74234f7dd3f4ef7f1505c50fb0c commit 220 157 82476c5e45f8e295226b1bc5c8c7e2bc98d7eae6be1 commit 74 85 981 1 b6f173085f49f109a00b2a3f08a7dc499cc47f1f2729f1fa896d384b49a2f5c53d483eacc0929ebb commit 172 127 10663cc58df83752123644fef39faab2393af643b1d2 blob   2 11 119362189d1a10cc2a544c4e5b9c4aba9493cf5782dc blob   8 15 1204a9a5aecf429fd8a0d81fbd5fd37006bfa498d5c1 blob   4 13 12192b8982f7c281964658d2cd8b6c17b541533dd277 tree   104 105 123292c4aafa39ee387a1f8237f00c78c499aebaf0b2 tree   104 105 1337223b7836fb19fdf64ba2d3cd6173c6a283141f78 blob   2 11 14421756ca64f21724f350fe2cc5cfb218883e314c3d tree   71 80 1453e11ddfa79f01b01a8e1553bbffaa2d6c03ae9f6e tree   71 80 1533f70f10e4db19068f79bc43844b49f3eece45c4e8 blob   2 11 1613e982b6207b10a869164e2c8d19d25ffb059e6a16 tree   66 73 1624f2e9f73f27124916344e0fd03bb449bc6feca59d tree   66 74 1697d09da444f461d7cee3679666a1ded5ab79832ed0 tree   33 44 1771non delta: 18 objectschain length &#x3D; 1: 3 objectspack-efbf3149604d24e6ea427b025da0c59245b2c2ea.pack: ok</span><br></pre></td></tr></table></figure>



<p>如 399334856af4ca4b49c0008a25b6a9f524e40350(SHA-1) 表示对象的 base object SHA-1 是 cb5a93c4cf9c0ee5b7153a3a35a4fac7a7584804，base 对象最大深度 (depth) 为 1，如果 cb5a93c4cf9c0ee5b7153a3a35a4fac7a7584804 还有引用对象，则改变 depth 为 2。</p>
<p>pack Header 中最后 4-bytes 用于表示的 pack 文件中 objects 的数量，最多 2 的 32 次方个对象，所以一些大的工程中有多个 pack 文件和多个 idx 文件。</p>
<p>文件的 size (文件解压缩后大小) 有什么用呢，这个是为了方便我们进行解压的时候，设置流的大小，也就是方便知道流有多大。这里 size 不是说明下一个文件的偏移量，偏移量都是来自索引文件，见下面 idx：</p>
<p>index 文件</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb99nf6xw3UVlcFvlMdF2e1VZrxFOiciawG9WR6oua3BviaMZkOBvVevr0qA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>由于 version1 比较简单，下面用 version2 为例子：</p>
<p>分层模式：Header，Fanout,SHA，CRC，Offset，Big File Offset，Trailer。</p>
<p><strong>Header 层</strong></p>
<p>version2 的 Header 部分总共有 8-bytes，version 1 的 header 部分是没有的，前 4-bytes 总是 255, 116, 79, 99 因为这个也是版本 1 的开头四个字节，后面 4-bytes 用于表示的是版本号，在当前就是 version 2。</p>
<p><strong>Fanout 层</strong></p>
<p>fanout 层是 git 的亮点设计，也叫 Fanout Table（扇表）。fanout 数组中存储的是相关对象的数目，数组下标是对应 16 进制数。fanout 最后一个存储的是整个 pack 文件中所有对象的总数量。Fanout Table 是整个 git 检索的核心，通过它我们可以快速进行查询，用于定位 SHA 层的数组起始 - 终止下标，定位好 SHA 层范围之后，就可以对 SHA 层进行二分查找了，而不用对所有对象进行二分查找。</p>
<p>fanout 总共 256 个，刚好是十六进制的 #0xFF。fanout 数组用 SHA 的前面 2 个字符作为下标(对应 .git/objects 中的松散文件目录名，将 16 进制的目录名转换 10 进制数字)，里面值就是用这两个字符开头的文件数量，而且是逐层累加的，后面的数组数量是包含前面数组的数据的个数的一个累加。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb94I6Ao3GiaQqdpoGdjPSrra6CopjZ6kfCiap0X4olUMlgSQ8tp7GQlXicQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>举例如下：</p>
<p>1）如果数组下标为 0，且 Fanout[0] = 10 代表着 #0x00 开头的 SHA-1 值的总数为 10 个。</p>
<p>2） 如果数组下标为 1，且 Fanout[1] = 15 代表着小于 #0x01 开头的 SHA-1 值的总数为 15 个，从 Fanout[0] = 10 知 Fanout[1] = （15-10）</p>
<p>为什么 git 设计上 Fanout[n] 会累加 Fanout[n-1] 的数量？这个主要是为了快速确定 SHA 层检索的初始位置，而不用每次去把前面所有 fanout[..n-1] 数量进行累加。</p>
<p><strong>SHA 层</strong></p>
<p>是所有对象的 SHA-1 的排序，按照名称排序，按照名称进行排序是为了用二分搜索进行查找。每个 SHA-1 值占 20-bytes。</p>
<p><strong>CRC 层</strong></p>
<p>由于文件打包主要解决网络传输问题，网络传输的时候必须通过 crc 进行校验，避免传输过程中的文件损坏。CRC 数组对应的是每个对象的 CRC 校验和。</p>
<p><strong>Offset 层</strong></p>
<p>是由 4 byte 字节所组成，表示的是每个 SHA-1 文件的偏移量，但是如果文件大于 2G 之后，4 byte 字节将无法表示，此时将：</p>
<p>4 byte 中的第一 bit 就是 MSB，如果是 1 表示的是文件的偏移量是放在第 6 层去存储，此时剩下的 31-bits 将表示文件在 Big File Offset 中的偏移量，也就是图中的，通过 Big File Offset 层 就可以知道对象在 pack 中的 offset。</p>
<p>4 byte 中的第一 bit 就是 MSB，如果是 0 31-bits 表示的存储对象在 packfile 中的文件偏移量，此时不涉及 Big File Offset 层</p>
<p><strong>Big File Offset 层</strong></p>
<p>用于存储大于 2G 的文件的偏移量。如果文件大于 2G，可以通过 offset 层最后 31 bits 决定在 big file offset 中的位置，big file offset 通过 8 bytes 来表示对象在 pack 文件中的位置，理论上可以表示 2 的 64 次方文件大小。</p>
<p><strong>Trailer 层</strong></p>
<p>包含的是 packfile checksum 和关联的 idx 的 checksum。</p>
<p><strong>索引流程</strong></p>
<p>从上面的分层知道 git 设计的巧妙。git 索引文件偏移量的查询流程如下：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9W190VJCiapx51Yqo5r55PzgPhBwX8n88zUp19e70pW3Rpia7fkEp1lPQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>查询算法</p>
<p>通过 idx 文件查询 SHA-1 对应的偏移量：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb91cQuaeDQ2DS2Xdvu3TeHvHl1BWlvm46icOF6gPXSe2icm0rzEqXdJkNA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>在 pack 文件中通过偏移量找到对象：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naLaUlprPbJo4hLyFYOEfXb9iawwujQXpjWWrf9HicXpKZXQSjwq7dk5MJ7y7z4hVO3QPWlr3QNREP0w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>如果是普通的存储类型。定位到的对象就是用 Zlib 压缩之后的对象，直接解压缩即可。</p>
<p>如果是 Delta 类型需要 递归查出 Delta 的 Base 对象，然后再把 delta data 应用到 base object 上(可参考 git-apply-delta)。</p>
<h1 id="通俗易懂的git命令讲解"><a href="#通俗易懂的git命令讲解" class="headerlink" title="通俗易懂的git命令讲解"></a>通俗易懂的git命令讲解</h1><h2 id="Git-体系介绍"><a href="#Git-体系介绍" class="headerlink" title="Git 体系介绍"></a>Git 体系介绍</h2><p>开局一张图，结论先靠猜。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1b2c9f2b1ea1447b8daed1c7568b1bfe~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt="Git 体系图"></p>
<h3 id="Git-区域理解"><a href="#Git-区域理解" class="headerlink" title="Git 区域理解"></a>Git 区域理解</h3><ul>
<li><code>远程仓库区</code>：也就是我们代码最终提交的归宿，没啥好说的。</li>
<li><code>远端分支本地副本</code>：这个其实主要储存了远程仓库各分支数据在本地的一个副本，你可以打开你 Git 项目下的 .git 文件，里面有个 refs/remotes，这里就主要存的就是远程仓库的分支信息，一般你执行 push 或者 pull、fetch 都会往这里进行更新。</li>
<li><code>本地分支</code>：这里就是我们经常会打交道的区域，你在执行 commit 之后，本质上就是提交到了这个区域，你可以查看你的 .git 目录下的 refs/heads 目录，里面存的就是我们本地的分支代码信息。</li>
<li><code>暂存区</code>：这个区域就是我们每次执行 git add 之后会存到的区域，用来与本地仓库之间做一个缓存，同时也是 Git 底层设计上来说也算是比较重要的一个区域，它能帮助 Git 在做 diff 的时候提高查找性能。</li>
<li><code>工作区</code>：这个一般就是我们写代码的地方，比如你的 vscode 打开的项目，你可以进行代码编辑的地方。</li>
</ul>
<h4 id="stash"><a href="#stash" class="headerlink" title="stash"></a>stash</h4><p>除此之外，还有一个特殊的区域，那就是本地的 git 储存区，它是用来干嘛的呢？一般来说你可能在某些场景下会用到它，我们有的时候本地改了代码，但是突然有个人过来问你另一个分支的问题，同时这个时候你在实现某个功能，实现一半，又不想提交到 Git 仓库中，那么你就可以考虑使用 <code>git stash save &quot;临时存一下&quot;</code>，这个时候它就会帮你存到这个储存区，你去其他分支做完事情回来，再 <code>git stash pop</code>就好了。</p>
<blockquote>
<p>但笔者还是不是很建议使用这个功能，因为哪天你切走了再切回来，忘记了这个存储，又写了点其他的，这个时候你到时候被坑一把就哭吧。当然了，这个功能还是很有用的，但是的确需要细心点用。</p>
</blockquote>
<h3 id="Git-简单工作流理解"><a href="#Git-简单工作流理解" class="headerlink" title="Git 简单工作流理解"></a>Git 简单工作流理解</h3><p>日常工作中，我们可能在 Git 使用上频繁交互的流程大致会是这样的（不同规范下会有一些区别，但是大差不大）：</p>
<ol>
<li>来了一个新需求，我们会从 master checkout 一个新的 feature 分支出来进行开发。</li>
<li>开发完某个功能点，我们会执行 <code>git add</code> 将代码提交到暂存区。</li>
<li>执行 <code>git commit</code> 将代码提交到本地仓库</li>
<li>执行 <code>git push</code> 将代码提交到远端分支</li>
<li>当我们开发完所有需求之后，可能会设立一个专门的测试分支比如名叫 dev 的分支，那么我们就把代码合并到这个测试分支上，发布测试环境进行测试。</li>
<li>测试完毕之后，我们就需要合代码了，这个时候，我们可以发起一个 merge request，将我们的代码走 CR 流程合并到 master 分支。</li>
<li>在提交 MR 的过程中，我们一般需要先自己预先将 master 分支的代码合并到当前需要被合并的分支，提交并解决冲突。</li>
</ol>
<p>以上流程大致概括了一般常规的 Git flow 流程，不同的公司可能会设计自己的规范，这里就不过多指示了。</p>
<h2 id="命令概览"><a href="#命令概览" class="headerlink" title="命令概览"></a>命令概览</h2><ul>
<li><code>git stash</code></li>
<li><code>git clone</code></li>
<li><code>git init</code></li>
<li><code>git remote</code></li>
<li><code>git branch</code></li>
<li><code>git checkout</code></li>
<li><code>git add</code></li>
<li><code>git commit</code></li>
<li><code>git rm</code></li>
<li><code>git push</code></li>
<li><code>git pull</code></li>
<li><code>git fetch</code></li>
<li><code>git merge</code></li>
<li><code>git log</code></li>
<li><code>git reset</code></li>
<li><code>git reflog</code></li>
<li><code>git revert</code></li>
<li><code>git cherry-pick</code></li>
<li><code>git tag</code></li>
<li><code>git rebase</code></li>
</ul>
<p>乍一看，眼花缭乱，当场决定放弃，还是用可视化工具吧。莫慌，且让笔者为你娓娓道来。</p>
<h2 id="命令解析"><a href="#命令解析" class="headerlink" title="命令解析"></a>命令解析</h2><p>一般来说，我们本地如果想要使用 Git 管理一些资源文件，首先我们需要有一个仓库才行。常用的方式莫过于，第一去 Gitlab / Github 先创建一个仓库，然后再拉到本地，那这个时候我们就可以用到我们的 clone 命令了。</p>
<h3 id="git-stash（临时插进来快速介绍一下）"><a href="#git-stash（临时插进来快速介绍一下）" class="headerlink" title="git stash（临时插进来快速介绍一下）"></a>git stash（临时插进来快速介绍一下）</h3><p>上面也有初步介绍这个命令的用法，就是用来临时存一下不想被提交的代码变更的，常用命令如下：</p>
<ul>
<li><code>git stash save &#39;xxx&#39;</code>: 储存变更</li>
<li><code>git stash list</code>: 查看储存区所有提交列表</li>
<li><code>git stash pop</code>: 弹出并应用最近的一次储存区的代码提交</li>
<li><code>git stash drop stash@{n}</code>: 删除某次储存记录</li>
<li><code>git stash clear</code>: 清楚所有 stash 信息</li>
</ul>
<p>它的数据将被存在你仓库 .git 文件下的 refs/stash 里。</p>
<h3 id="git-clone"><a href="#git-clone" class="headerlink" title="git clone"></a>git clone</h3><p>最基础也是最常用的用法莫过于直接使用</p>
<ul>
<li><code>git clone xxx.git</code></li>
</ul>
<p>这样就能轻松把一个仓库代码拉到本地了，但仅仅知道这一点似乎还不太够。一般我们直接 clone 下来不带参数的话，它会默认停留在 master 分支，有的时候我们依旧需要一些其他诉求，比如怎么拉到本地之后自动切到指定分支呢？</p>
<ul>
<li><code>git clone xxx.git -b branch1</code></li>
</ul>
<p>有了仓库之后，我们总不能一直在 master 分支搞事吧，一般是不是都需要开个新分支改代码，再最后完事了再合到 master，那就需要用到下面介绍 git branch 命令了，不过呢，在讲到具体的分支操作之前呢，笔者还是要先补一下有关于本地仓库的初始化的流程。</p>
<h3 id="git-init"><a href="#git-init" class="headerlink" title="git init"></a>git init</h3><p>除了我们从远端建仓库，有的时候我们自己本地也是可以自己初始化一个 Git 仓库来操作的，这个时候我们就直接使用 git init 就能轻松为当前目录创建一个 git 仓库，也就能开始对当前目录的改动纳入版本管理库了。</p>
<p>不过本地 init 的仓库没法和远端进行交互，所以我们还是需要去 github/gitlab 创建一个远端仓库，然后关联一下，也就是 <code>git remote</code> 命令了。</p>
<h3 id="git-remote"><a href="#git-remote" class="headerlink" title="git remote"></a>git remote</h3><p>用于和远程仓库进行关系绑定处理等等操作。</p>
<ul>
<li><code>git remote add</code>: 添加一个远程版本库关联</li>
<li><code>git remote rm</code>: 删除某个远程版本库关联</li>
</ul>
<p>比如我们本地有个初始化好的仓库，同时还有一个创建好的远程空仓库，那么我们就可以执行一下操作让他们关联起来：</p>
<ol>
<li><code>git remote add origin xxx.git</code>先添加到本地仓库</li>
<li><code>git push -u origin master</code>：表示把当前仓库的 master 分支和远端仓库的 master 分支关联起来，后面我们执行 push 或者 pull 都可以非常方便的进行操作了。</li>
</ol>
<h3 id="git-branch"><a href="#git-branch" class="headerlink" title="git branch"></a>git branch</h3><p>在拿到一个项目之后，你首先还是应该看一下当前仓库现在有哪些分支，不要待会创建新分支发现名字重复之类的问题，那这个时候我们就可以使用 <code>git branch</code> 来查看一下相关的分支了。</p>
<ul>
<li><code>git branch</code>：查看本地所有分支信息</li>
<li><code>git branch -r</code>：查看远程仓库所有分支</li>
<li><code>git branch -a</code>：查看本地和远程仓库所有分支</li>
</ul>
<p>一般来说如果分支太多的话，还是建议使用可视化工具来查看分支信息，比如 vscode 或者 source tree 等软件等等。</p>
<blockquote>
<p>当然 IDEA 也是可以的。</p>
</blockquote>
<h3 id="git-checkout"><a href="#git-checkout" class="headerlink" title="git checkout"></a>git checkout</h3><p>如果我们想以当前分支为基准，创建一个新的分支并切换过去，可以使用如下命令。</p>
<ul>
<li>创建并切换到指定新分支：<code>git checkout -b branch1</code></li>
</ul>
<h3 id="git-add"><a href="#git-add" class="headerlink" title="git add"></a>git add</h3><p>我们在某个分支更改了代码之后，想要把它提交一下，那么你第一步要做的就是，执行 <code>git add</code></p>
<ul>
<li><code>git add [file1] [file2]</code>: 添加一个或多个文件到暂存区</li>
</ul>
<p>一般我们平时在使用的时候，用的比较多的应该还是：</p>
<ul>
<li><code>git add .</code>：把当前目录下得所有文件改动都添加到暂存区</li>
<li><code>git add -A</code>：把当前仓库内所有文件改动都添加到暂存区</li>
</ul>
<blockquote>
<p>对笔者来说，用的最多的还是这个 git add -A 命令，因为大多数情况，我们都应该把所有变更都加到暂存区里，如果没有，那大概率是忘了。</p>
</blockquote>
<h3 id="git-commit"><a href="#git-commit" class="headerlink" title="git commit"></a>git commit</h3><p>文件添加到暂存区之后，我们就可以执行下一步操作了。</p>
<ul>
<li><pre><code>git commit [file1] ... -m [message]
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  ：将暂存区的内容提交到本地 git 版本仓库中</span><br><span class="line"></span><br><span class="line">  - -m 表示的是当前提交的信息</span><br><span class="line">  - -a 对于已经被纳入 git 管理的文件（该文件你之前提交过 commit），那么这个命令就相当于帮你执行了上述 &#96;git add -A&#96;，你就不用再 add 一下了；对于未被 git 管理过的（也就是新增的文件），那么还是需要你先执行一下 &#96;git add -A&#96;，才能正确被 commit 到本地 git 库。</span><br><span class="line"></span><br><span class="line">通常情况下，我们用的比较多得应该是 &#96;git commit -m &#39;feat: do something&#39;&#96;，设置当前提交的信息。当然，如果你没有强诉求需要 &#96;git add&#96; 和 &#96;git commit&#96; 一定要分开，那你大可选择 &#96;git commit -am&#96;，方便又快捷。</span><br><span class="line"></span><br><span class="line">### git rm</span><br><span class="line"></span><br><span class="line">这个其实也挺有用的，比如我们项目中有个文件叫 .env，这个文件是一个私有的，不能被提交到远程的，但是我们不小心提交到了本地仓库中，这个时候我们把这个文件添加到 .gitignore 文件中，表示需要被 git 忽略提交，但是由于我们已经提交到本地仓库了，所以如果不先从 git 仓库删除是没用的。</span><br><span class="line"></span><br><span class="line">如果直接右键删除，那么这个文件的记录还是会被保存到远端仓库，别人还是能看得到你这个信息，所以我们需要先从 git 仓库中删掉这个文件才行。</span><br><span class="line"></span><br><span class="line">- &#96;git rm .env&#96;：执行完这个命令就表示 .env 文件从 git 仓库中删除了，配合 .gitignore 就能保证以后所有的 .env 文件变更都不用担心被提交到远程仓库。</span><br><span class="line">- &#96;git rm -r dist&#96;：如果我们要删除的是一个目录，那么加上 -r 参数就好了。</span><br><span class="line"></span><br><span class="line">### git push</span><br><span class="line"></span><br><span class="line">接下来我们想要把刚创建好得分支推送到远端，一般来说我们可能会需要用到 git push，但我们这是个新分支，根本没和远端仓库建立任何联系，那么我们就需要加点参数，让他们关联上：</span><br><span class="line"></span><br><span class="line">- 推送分支并建立关联关系：&#96;git push --set-upstream origin branch1&#96;</span><br><span class="line"></span><br><span class="line">完事之后我们可以再去远程仓库看一眼就会发现我们创建的新分支已经推上去了。接下来可能会有小伙伴要问了，那如果远端仓库已经有了这个分支名咋整？</span><br><span class="line"></span><br><span class="line">这里就分两种：</span><br><span class="line"></span><br><span class="line">1. 一种就是你本地的代码和远端代码没有冲突的情况下，并且你本地有新增提交，那么你可以仍然执行上述命令，这样就会直接将当前本地分支合远程分支关联上，同时把你的改动提交上去。</span><br><span class="line">2. 另一种就是本地分支和远端分支存在冲突，这个时候你执行上述命令就会出现提示冲突，那么接下来就需要你先把远端当前分支的代码拉下来，解决一下冲突了，就需要用到 git pull 命令了。</span><br><span class="line"></span><br><span class="line">### git pull</span><br><span class="line"></span><br><span class="line">通常情况下，如果当前分支已经和远端分支建立了联系，那么我们想要合并一下远端分支，只需要执行 &#96;git pull&#96; 就好了，不用带其他参数，但如果和上面提到的 git push 时产生了冲突，还没有建立联系的时候，我们就需要指定需要拉取哪个分支的代码下来进行合并了。</span><br><span class="line"></span><br><span class="line">- 拉取指定远端分支合并到本地当前分支：&#96;git pull origin branch1&#96;</span><br><span class="line"></span><br><span class="line">这里的 origin 是我们对远端仓库的命名，想改也是可以的，不过一般都是用的 origin。</span><br><span class="line"></span><br><span class="line">回到上面提到的冲突问题，我们可以直接使用 git pull 然后指定合并当前本地分支想要建立联系的远程分支，然后本地解决一下冲突，然后提交一下改动，再执行 &#96;git push --set-upstream origin branch1&#96; 命令就大功告成了。</span><br><span class="line"></span><br><span class="line">### git fetch</span><br><span class="line"></span><br><span class="line">了解完上面描述的 &#96;git pull&#96;，命令之后，其实这个命令也很好理解了，特定时候，可能我们只是想把远端仓库对应分支的变更拉到本地而已，并不想自动合并到我的工作区（你当前正在进行代码变更的工作区），等晚些时候我写完了某部分的代码之后再考虑合并，那么你就可以先使用 &#96;git fetch&#96;。</span><br><span class="line"></span><br><span class="line">fetch 完毕之后，我提交了自己当前工作去的变更到本地仓库，然后想合并一下远端分支的更改，这个时候执行一下 &#96;git merge origin&#x2F;[当前分支名]&#96;（默认一般是用 origin 表示远端的分支前缀）即可。</span><br><span class="line"></span><br><span class="line">### git merge</span><br><span class="line"></span><br><span class="line">合并指定分支代码到当前分支。一般来说，我们用的比较多的场景可能是，远端仓库 master 分支有变更了，同时这个时候我们准备提 MR 了，那么就需要先合一下 master 的代码，有冲突就解决下冲突，那这个时候我们可以做以下操作：</span><br><span class="line"></span><br><span class="line">1. 切到 master 分支，git pull 拉一下最新代码</span><br><span class="line">2. 切回开发分支，执行 git merge master 合并一下 master 代码</span><br><span class="line"></span><br><span class="line">同理，上面介绍的 git merge origin&#x2F;xxx 也是一样的用法。</span><br><span class="line"></span><br><span class="line">### git log</span><br><span class="line"></span><br><span class="line">顾名思义，就是日志的意思，执行这个命令之后，我们能看到当前分支的提交记录信息，比如 commitId 和提交的时间描述等等，大概长下面这样：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;shell</span><br><span class="line">commit e55c4d273141edff401cbc6642fe21e14681c258 (HEAD -&gt; branch1, origin&#x2F;branch1)</span><br><span class="line">Author: 陌小路 &lt;44311619+STDSuperman@users.noreply.github.com&gt;</span><br><span class="line">Date:   Mon Aug 1 23:16:11 2022 +0800</span><br><span class="line"></span><br><span class="line">    Initial commit</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
</code></pre></li>
</ul>
<p>这个时候可能有读者会问了，这个都用来干啥的，简单的用法呢就是看看有谁提交了啥，还有更重要的用法呢就是进行代码版本的回滚，或者其他有意思的操作，且听笔者为你微微道来。</p>
<h3 id="git-reset"><a href="#git-reset" class="headerlink" title="git reset"></a>git reset</h3><ul>
<li>git reset [–soft | –mixed | –hard] [HEAD]</li>
</ul>
<h4 id="关于-HEAD："><a href="#关于-HEAD：" class="headerlink" title="关于 HEAD："></a>关于 HEAD：</h4><ul>
<li>HEAD 表示当前版本</li>
<li>HEAD^ 上一个版本</li>
<li>HEAD^^ 上上一个版本</li>
<li>HEAD^^^ 上上上一个版本</li>
<li>HEAD~n 回撤 n 个版本，这种也是更加方便的</li>
</ul>
<h4 id="参数解析"><a href="#参数解析" class="headerlink" title="参数解析"></a>参数解析</h4><p>以下解析均基于后接参数为 HEAD^，也就是<code>git reset HEAD^</code>。</p>
<ul>
<li><code>--soft</code>: 重置你最新一次提交版本，不会修改你的暂存区和工作区。</li>
<li><code>--mixed</code>: 默认参数，用于重置暂存区的文件与上一次的提交(commit)保持一致，工作区文件内容保持不变。</li>
<li><code>--hard</code>: 重置所有提交到上一个版本，并且修改你的工作区，会彻底回到上一个提交版本，在代码中看不到当前提交的代码，也就是你的工作区改动也被干掉了。</li>
</ul>
<p>说了半天似乎不是很好理解，我们举个栗子理解下：</p>
<p>比如：</p>
<ol>
<li>我改动了我的 README 文件，在我们的工作区就产生了一次改动，但是这个时候还没有提交到暂存区，在 vscode 里会显示为工作区修改的标记</li>
<li>接着我们执行 <code>git add</code>，这个时候你查看暂存区，会发现这次改动被提交进去了，同时被 vscode 标记为已被提交至暂存区</li>
<li>然后再执行 <code>git commit</code>，这个时候就完成了一次提交</li>
</ol>
<p>接下来我们想撤回这次提交，以上三种参数所体现的表现会是这样的：</p>
<ul>
<li><code>--soft</code>：我们对 README 的更改状态现在变成已被提交至暂存区，也就是上面 2 的步骤。</li>
<li><code>--mixed</code>： 我们对 README 的更改变成还未被提交至暂存区，也就是上面 1 的步骤。</li>
<li><code>--hard</code>：我们对 README 的所有更改全没了，git log 中也找不到我们对 README 刚刚那次修改的痕迹。</li>
</ul>
<p>默认情况下我们不加参数，就是 –mixed，也就是重置暂存区的文件到上一次提交的版本，文件内容不动。一般会在什么时候用到呢？</p>
<h4 id="场景一（撤销-git-add）"><a href="#场景一（撤销-git-add）" class="headerlink" title="场景一（撤销 git add）"></a>场景一（撤销 git add）</h4><p>可能大部分情况下，比如 vscode 其实大家更习惯于使用可视化的撤销能力，但是呢，这里我们其实也可以稍微了解下这其中的奥秘，其实也很简单：</p>
<ul>
<li>方式一：<code>git reset</code></li>
<li>方式二：<code>git reset HEAD</code></li>
</ul>
<p>其实一二都是一样，如果 reset 后面不跟东西就是默认 HEAD。</p>
<h4 id="场景二-撤销-git-commit"><a href="#场景二-撤销-git-commit" class="headerlink" title="场景二 (撤销 git commit)"></a>场景二 (撤销 git commit)</h4><p>当你某个改动提交到本地仓库之后，也就是 commit 之后，这个时候你想撤回来，再改点其他的，那么就可以直接使用 <code>git reset HEAD^</code>。这个时候你会惊奇的发现，你上一版的代码改动，全部变成了未被提交到暂存区的状态，这个时候你再改改代码，然后再提交到暂存区，然后一起再 commit 就可满足你的需求了。</p>
<p>除了这种基础用法，我们还可以配合其他命令操作一下。</p>
<h4 id="场景三"><a href="#场景三" class="headerlink" title="场景三"></a>场景三</h4><p>某一天你老板跟你说，昨天新加的功能不要了，给我切回之前的版本看看效果，那么这个时候，你可能就需要将<em>工作区</em>的代码回滚到上一个 commit 版本了，操作也十分简单：</p>
<ul>
<li><code>git log</code> 查看上一个 commit 记录，并复制 commitId</li>
<li><code>git reset --hard commitId</code> 直接回滚。</li>
</ul>
<h4 id="场景四"><a href="#场景四" class="headerlink" title="场景四"></a>场景四</h4><p>如果某一个你开发需求正开心呢，突然发现，自己以前改的某个东西怎么不见了，你想起来好像是某次合并，没注意被其他提交冲掉了，你心一想，完了，写了那么多，怎么办？很简单，回到有这份代码的那个版本就好了（前提你提交过到本地仓库）。</p>
<p>假设我们有这么两个提交记录，我们需要下面那个 365 开头 commitId 的代码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">commit e62b559633387ab3a5324ead416f09bf347d8e4a (HEAD -&gt; master)</span><br><span class="line">Author: xiaohang.lin &lt;xiaohang.lin@alibaba-inc.com&gt;</span><br><span class="line">Date:   Sun Aug 14 18:08:56 2022 +0800</span><br><span class="line"></span><br><span class="line">    merge</span><br><span class="line"></span><br><span class="line">commit 36577ea21d79350845f104eee8ae3e740f19e038 (origin/master, origin/HEAD)</span><br><span class="line">Author: 陌小路 &lt;44311619+STDSuperman@users.noreply.github.com&gt;</span><br><span class="line">Date:   Sun Aug 14 15:57:34 2022 +0800</span><br><span class="line"></span><br><span class="line">    Update README.md</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<ol>
<li>抢救第一步 <code>git log</code> 找到有你这个代码的那个 commitId（也就是 36577ea21d79350845f104eee8ae3e740f19e038）</li>
<li>抢救第二步 <code>git reset --hard commitId</code></li>
<li>第三步：Ctrl + c 你的目标代码</li>
</ol>
<p>这个时候你想把复制好的代码写回去，该怎么办呢，你可能会再 git log 看一下我们 reset 之前的 commitId，你会发现，完了，之前的 commitId 都没了，只有这个 365 了。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">commit 36577ea21d79350845f104eee8ae3e740f19e038 (origin/master, origin/HEAD)</span><br><span class="line">Author: 陌小路 &lt;44311619+STDSuperman@users.noreply.github.com&gt;</span><br><span class="line">Date:   Sun Aug 14 15:57:34 2022 +0800</span><br><span class="line"></span><br><span class="line">    Update README.md</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>不要慌，请记住一句话，只要你不删你本地的 .git 仓库，你都能找回以前所有的提交。</p>
<p>git log 看不到的话，我们就可以祭出我们的绝招了：<code>git reflog</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">36577ea (HEAD -&gt; master, origin/master, origin/HEAD) HEAD@&#123;0&#125;: reset: moving to 36577ea21d79350845f104eee8ae3e740f19e038</span><br><span class="line">e62b559 HEAD@&#123;1&#125;: reset: moving to e62b559633387ab3a5324ead416f09bf347d8e4a</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>这里我们可以看到两行记录，一个是我们执行 reset 到 365 的记录，另一条不知道是啥，不重要，我们想回到我们刚刚 reset 之前的状态也很简单，直接复制它上一次的变动也就是这个 e62b559，然后执行 <code>git reset --hard e62b559</code>，然后你会惊奇的发现，你之前的代码又回来了。</p>
<p>接下来把你以前版本的代码，再 Ctrl + v 放进来就完成了。</p>
<h3 id="git-reflog"><a href="#git-reflog" class="headerlink" title="git reflog"></a>git reflog</h3><p>介绍：用来查看你的所有操作记录。</p>
<p>既然 git log 看不到我之前 commitId 了，那么就回到 reset 之前的状态吧！</p>
<h3 id="git-revert"><a href="#git-revert" class="headerlink" title="git revert"></a>git revert</h3><p>当然了，如果是针对 master 的操作，为了安全起见，一般还是建议使用 revert 命令，他也能实现和 reset 一样的效果，只不过区别来说，reset 是向后的，而 revert 是向前的，怎么理解呢？简单来说，把这个过程当做一次时光穿梭，reset 表示你犯了一个错，他会带你回到没有犯错之前，而 revert 会给你一个弥补方案，采用这个方案之后让你得到的结果和没犯错之前一样。</p>
<p>举个栗子： 假设你改了 README 的描述，新增了一行文字，提交上去了，过一会你觉得这个写了有问题，想要撤销一下，但是又不想之前那个提交消失在当前历史当中，那么你就可以选择使用 git revert [commitId]，那么它就会产生一次新的提交，提交的内容就是帮你删掉你上面新增的内容，相当于是一个互补的操作。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS D:\Code\other\git-practice&gt; git revert 3b18a20ad39eea5264b52f0878efcb4f836931ce</span><br><span class="line">On branch branch2</span><br><span class="line">Your branch is ahead of 'origin/branch2' by 1 commit.</span><br><span class="line">  (use "git push" to publish your local commits)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>这个时候，它会提示你可以把新的改动 push 上去了。</p>
<p>其实你如果在 gitlab 进行 mr 之后，想要回滚这个 mr，一般它会给你一个 revert 的按钮选项，让你进行更安全的回滚操作。</p>
<h3 id="git-cherry-pick"><a href="#git-cherry-pick" class="headerlink" title="git cherry-pick"></a>git cherry-pick</h3><p>其实对于我们工作中大部分场景下应该用不到这个功能，但是呢有的时候这个命令又能挽救你于水火之间，那就是当某个倒霉蛋忘记切分支，然后在 master 分支上改了代码，并且提交到了本地仓库中，这个时候使用<code>git cherry-pick</code>简直就是神器了。</p>
<ul>
<li><code>git cherry-pick</code>：将执行分支的指定提交合并到当前分支。</li>
</ul>
<p>一听介绍就来精神了，雀氏有点东西，比如我在 master 分支提交了某个需求的代码，同时还没提交到远程分支，那么你就可以先 <code>git log</code> 查看一下当前的提交，找到 master 分支正常提交之后的所有 commitId，然后复制出来，然后再切到你建好的开发分支，接着执行 <code>git cherry-pick master commitId1 commitId2 commitId4</code>。</p>
<p>完事之后记得清理一下作案现场，把你的 master 分支代码恢复到正常的提交上去。</p>
<h3 id="git-tag"><a href="#git-tag" class="headerlink" title="git tag"></a>git tag</h3><p>顾名思义，也就是打标签的意思。一般可能会在你发布了某个版本，需要给当前版本打个标签，你可以翻阅 vite 的官方 git 仓库，查看它的 tag 信息，它这里就标注了各个版本发布时候的 tag 标签。</p>
<p>它有两种标签形式，一种是轻量标签，另一种是附注标签。</p>
<h4 id="轻量标签"><a href="#轻量标签" class="headerlink" title="轻量标签"></a>轻量标签</h4><ul>
<li>创建方式：<code>git tag v1.0.0</code></li>
</ul>
<p>它有点像是对某个提交的引用，从表现上来看，它又有点像基于当前分支提交给你创建了一个不可变的分支，它是支持你直接 checkout 到这个分支上去，但是它和普通分支还是有着本质的区别的，如果你切换到了这个 tag “分支”，你去修改代码同时产生了一次提交，亦或者是 reset 版本，这对于该 tag 本身不会有任何影响，而是为你生成了一个独立的提交，但是却在你的分支历史中是找不到的，你只能通过 commitId 来切换到本次提交，看图：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/349e2b8829454c07a916bf8c060ca8db~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt="tag commitId"></p>
<p>那如果你从其他分支通过 commitId 切换到这个改动上，它会提示你以下内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Note: switching to 'be276009'.</span><br><span class="line"></span><br><span class="line">changes and commit them, and you can discard any commits you make in this</span><br><span class="line">state without impacting any branches by switching back to a branch.</span><br><span class="line"></span><br><span class="line">If you want to create a new branch to retain commits you create, you may</span><br><span class="line">do so (now or later) by using -c with the switch command. Example:</span><br><span class="line"></span><br><span class="line">  git switch -c &lt;new-branch-name&gt;</span><br><span class="line"></span><br><span class="line">Or undo this operation with:</span><br><span class="line"></span><br><span class="line">  git switch -</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>大致意思就是你可以选择丢弃或者保留当前更改，如果需要保留的话直接使用下面的 <code>git switch</code> 命令创建一个新分支即可。</p>
<h4 id="附注标签"><a href="#附注标签" class="headerlink" title="附注标签"></a>附注标签</h4><ul>
<li>创建方式：<code>git tag -a v1.0.1 -m &quot;发布正式版 1.0.1&quot;</code></li>
</ul>
<p>引用官方文档的描述：</p>
<blockquote>
<p>而附注标签是存储在 Git 数据库中的一个完整对象， 它们是可以被校验的，其中包含打标签者的名字、电子邮件地址、日期时间， 此外还有一个标签信息，并且可以使用 GNU Privacy Guard （GPG）签名并验证。</p>
</blockquote>
<p>从概念上看，轻量标签更像是一个临时的标签，而附注标签更加正式一点，能够保留更多的信息。它创建的方式和轻量标签区别主要是 -a 和 -m 参数，如果你的 -m 参数不传，那么编辑器会让你手动填写。</p>
<h4 id="对比标签信息"><a href="#对比标签信息" class="headerlink" title="对比标签信息"></a>对比标签信息</h4><p>打完标签之后，我们可以使用 <code>git show</code> 命令来看看这两种标签最终体现的信息有哪些。</p>
<h5 id="轻量标签-1"><a href="#轻量标签-1" class="headerlink" title="轻量标签"></a>轻量标签</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">commit dcbd335be87f51eaa0cc1852400e64e9f46e84d8 (HEAD -&gt; test-branch1, tag: v1.0.2, tag: v1.0.1)</span><br><span class="line">Author: STDSuperman &lt;2750556766@qq.com&gt;</span><br><span class="line">Date:   Tue Aug 16 22:54:36 2022 +0800</span><br><span class="line"></span><br><span class="line">    xx</span><br><span class="line"></span><br><span class="line">diff --git a/README.md b/README.md</span><br><span class="line">index 715766a..b4cdea6 100644</span><br><span class="line">--- a/README.md</span><br><span class="line">+++ b/README.md</span><br><span class="line">@@ -1 +1,3 @@</span><br><span class="line"><span class="meta">-#</span><span class="bash"> git-practice</span></span><br><span class="line">\ No newline at end of file</span><br><span class="line">+# git-practice</span><br><span class="line">+</span><br><span class="line">+test tag</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h5 id="附注标签-1"><a href="#附注标签-1" class="headerlink" title="附注标签"></a>附注标签</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">tag v1.0.1</span><br><span class="line">Tagger: STDSuperman &lt;2750556766@qq.com&gt;</span><br><span class="line">Date:   Tue Aug 16 22:58:27 2022 +0800</span><br><span class="line"></span><br><span class="line">发布正式版 1.0.0</span><br><span class="line"></span><br><span class="line">commit dcbd335be87f51eaa0cc1852400e64e9f46e84d8 (HEAD -&gt; test-branch1, tag: v1.0.1)</span><br><span class="line">Author: STDSuperman &lt;2750556766@qq.com&gt;</span><br><span class="line">Date:   Tue Aug 16 22:54:36 2022 +0800</span><br><span class="line"></span><br><span class="line">    xx</span><br><span class="line"></span><br><span class="line">diff --git a/README.md b/README.md</span><br><span class="line">index 715766a..b4cdea6 100644</span><br><span class="line">--- a/README.md</span><br><span class="line">+++ b/README.md</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>从信息丰富度上来说，附注标签能保留的信息会更多。</p>
<h4 id="推送标签"><a href="#推送标签" class="headerlink" title="推送标签"></a>推送标签</h4><ul>
<li><code>git push origin tagName</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">&gt; git push origin v1.0.1</span></span><br><span class="line">Enumerating objects: 6, done.</span><br><span class="line">Counting objects: 100% (6/6), done.</span><br><span class="line">Delta compression using up to 12 threads</span><br><span class="line">Compressing objects: 100% (3/3), done.</span><br><span class="line">Writing objects: 100% (4/4), 448 bytes | 448.00 KiB/s, done.</span><br><span class="line">Total 4 (delta 0), reused 0 (delta 0), pack-reused 0</span><br><span class="line">To github.com:STDSuperman/git-practice.git</span><br><span class="line"> * [new tag]         v1.0.1 -&gt; v1.0.1</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>当然，附注标签和轻量标签都是可以被推送到远端的。</p>
<h4 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h4><ul>
<li><p>查看标签：<code>git tag</code></p>
</li>
<li><p>筛选标签：<code>git tag -l v1.0.1</code></p>
</li>
<li><p>删除标签：<code>git tag -d v1.0.1</code></p>
</li>
<li><p>删除远程标签：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin --delete v1.0.2</span><br></pre></td></tr></table></figure>

<ul>
<li>另一种删除远程方式（表示将“:”前面空值替换到远程，也不失为一种方式）：<code>git push origin :refs/tags/v1.0.1</code></li>
</ul>
</li>
</ul>
<h3 id="git-rebase"><a href="#git-rebase" class="headerlink" title="git rebase"></a>git rebase</h3><p>这块其实涉及的玩法会相对来说复杂一点，可能还是需要拿来和 merge 做一下对比才更加有意义，东西有点多，先搁置一下。</p>
<p>作者：陌小路<br>链接：<a href="https://juejin.cn/post/7131713973572861966" target="_blank" rel="noopener">https://juejin.cn/post/7131713973572861966</a><br>来源：稀土掘金<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/git/" rel="tag"># git</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/07/29/npm%E6%98%AF%E4%BB%80%E4%B9%88%E6%9C%80%E5%85%A8%E8%AE%B0%E5%BD%95/" rel="next" title="npm是什么最全记录">
                <i class="fa fa-chevron-left"></i> npm是什么最全记录
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/07/30/overflow/" rel="prev" title="overflow">
                overflow <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/header.jpg"
                alt="Dali" />
            
              <p class="site-author-name" itemprop="name">Dali</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">175</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">76</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">163</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#git命令"><span class="nav-number">1.</span> <span class="nav-text">git命令</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#简述git原理"><span class="nav-number">2.</span> <span class="nav-text">简述git原理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#一文讲透-Git-底层数据结构和原理"><span class="nav-number">3.</span> <span class="nav-text">一文讲透 Git 底层数据结构和原理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#通俗易懂的git命令讲解"><span class="nav-number">4.</span> <span class="nav-text">通俗易懂的git命令讲解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Git-体系介绍"><span class="nav-number">4.1.</span> <span class="nav-text">Git 体系介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Git-区域理解"><span class="nav-number">4.1.1.</span> <span class="nav-text">Git 区域理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#stash"><span class="nav-number">4.1.1.1.</span> <span class="nav-text">stash</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Git-简单工作流理解"><span class="nav-number">4.1.2.</span> <span class="nav-text">Git 简单工作流理解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#命令概览"><span class="nav-number">4.2.</span> <span class="nav-text">命令概览</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#命令解析"><span class="nav-number">4.3.</span> <span class="nav-text">命令解析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#git-stash（临时插进来快速介绍一下）"><span class="nav-number">4.3.1.</span> <span class="nav-text">git stash（临时插进来快速介绍一下）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-clone"><span class="nav-number">4.3.2.</span> <span class="nav-text">git clone</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-init"><span class="nav-number">4.3.3.</span> <span class="nav-text">git init</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-remote"><span class="nav-number">4.3.4.</span> <span class="nav-text">git remote</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-branch"><span class="nav-number">4.3.5.</span> <span class="nav-text">git branch</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-checkout"><span class="nav-number">4.3.6.</span> <span class="nav-text">git checkout</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-add"><span class="nav-number">4.3.7.</span> <span class="nav-text">git add</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-commit"><span class="nav-number">4.3.8.</span> <span class="nav-text">git commit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-reset"><span class="nav-number">4.3.9.</span> <span class="nav-text">git reset</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#关于-HEAD："><span class="nav-number">4.3.9.1.</span> <span class="nav-text">关于 HEAD：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参数解析"><span class="nav-number">4.3.9.2.</span> <span class="nav-text">参数解析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#场景一（撤销-git-add）"><span class="nav-number">4.3.9.3.</span> <span class="nav-text">场景一（撤销 git add）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#场景二-撤销-git-commit"><span class="nav-number">4.3.9.4.</span> <span class="nav-text">场景二 (撤销 git commit)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#场景三"><span class="nav-number">4.3.9.5.</span> <span class="nav-text">场景三</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#场景四"><span class="nav-number">4.3.9.6.</span> <span class="nav-text">场景四</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-reflog"><span class="nav-number">4.3.10.</span> <span class="nav-text">git reflog</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-revert"><span class="nav-number">4.3.11.</span> <span class="nav-text">git revert</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-cherry-pick"><span class="nav-number">4.3.12.</span> <span class="nav-text">git cherry-pick</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-tag"><span class="nav-number">4.3.13.</span> <span class="nav-text">git tag</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#轻量标签"><span class="nav-number">4.3.13.1.</span> <span class="nav-text">轻量标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#附注标签"><span class="nav-number">4.3.13.2.</span> <span class="nav-text">附注标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#对比标签信息"><span class="nav-number">4.3.13.3.</span> <span class="nav-text">对比标签信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#轻量标签-1"><span class="nav-number">4.3.13.3.1.</span> <span class="nav-text">轻量标签</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#附注标签-1"><span class="nav-number">4.3.13.3.2.</span> <span class="nav-text">附注标签</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#推送标签"><span class="nav-number">4.3.13.4.</span> <span class="nav-text">推送标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#其他命令"><span class="nav-number">4.3.13.5.</span> <span class="nav-text">其他命令</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#git-rebase"><span class="nav-number">4.3.14.</span> <span class="nav-text">git rebase</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dali</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
